<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>SDK Quick Start Guide by KocomojoLLC</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>SDK Quick Start Guide</h1>
        <p></p>

        <p class="view"><a href="https://github.com/KocomojoLLC/sample-ios-app">View the Project on GitHub <small>KocomojoLLC/sample-ios-app</small></a></p>


        <ul>
          <li><a href="https://github.com/KocomojoLLC/sample-ios-app/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/KocomojoLLC/sample-ios-app/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/KocomojoLLC/sample-ios-app">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="kocomojo-ios-sdk" class="anchor" href="#kocomojo-ios-sdk" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kocomojo iOS SDK</h1>

<p>Kocomojo is a location-based marketing service.</p>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<h3>
<a id="install-the-library" class="anchor" href="#install-the-library" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install the library</h3>

<p><strong>CocoaPods</strong></p>

<p>CocoaPods is preferred way to install Kocomojo iOS SDK. Install <a href="https://cocoapods.org/">CocoaPods</a> and add following lines to your Podfile:</p>

<pre><code>platform :ios, '7.0'
pod 'KocomojoSDK', '~&gt; 0.9'
</code></pre>

<p>Run <code>pod install</code> and don't forget to use .xcworkspace instead of .xcodeproj.</p>

<p><strong>Manual installation</strong></p>

<ol>
<li>Download <a href="http://assets.kocomojo.net/sdk/KocomojoSDK-0.9.0.tgz">KocomojoSDK-0.9.0.tgz</a>.</li>
<li>Unarchive the file you downloaded.</li>
<li>In Xcode, with your project open, click on 'File' then 'Add files to "Project"...'.</li>
<li>Select <code>KocomojoSDK.framework</code> in the directory you just unarchived.</li>
<li>Make sure 'Copy items if needed' is checked.</li>
<li>Click 'Add'.</li>
<li>Install dependencies:

<ul>
<li><a href="https://github.com/CocoaLumberjack/CocoaLumberjack">CocoaLumberjack</a></li>
<li><a href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a></li>
</ul>
</li>
<li>Add <code>CoreLocation</code> framework to the project</li>
</ol>

<h3>
<a id="insert-api-key" class="anchor" href="#insert-api-key" aria-hidden="true"><span class="octicon octicon-link"></span></a>Insert API Key</h3>

<ol>
<li>Open <a href="https://admin.kocomojo.net/admin/index.html#/dashboard">Kocomojo Dashboard</a> and sign-in using your username and password.</li>
<li>Click 'MOBILE APPS' in the sideboard.</li>
<li>Select an app in the list.</li>
<li>Click 'Show' button.</li>
<li>Enter username and password and click 'SIGN IN' button.</li>
<li>Copy API Key displayed</li>
<li>Insert following lines into <code>AppDelegate.m</code>, replacing '&lt;&lt; API KEY &gt;&gt;' with the copied API Key</li>
</ol>

<pre><code>// AppDelegate.m

#import "AppDelegate.h"
#import &lt;KocomojoSDK/KocomojoSDK.h&gt;

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application
didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
  [[KocomojoManager sharedManager] setApiKey:@"&lt;&lt; API KEY &gt;&gt;"];
  [[KocomojoManager sharedManager] startTracking];
  return YES;
}
@end
</code></pre>

<h3>
<a id="enable-location-tracking" class="anchor" href="#enable-location-tracking" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enable location tracking</h3>

<p>For iOS 8+ add the following entries to Info.plist:</p>

<pre><code>&lt;key&gt;NSLocationWhenInUseUsageDescription&lt;/key&gt;
&lt;string&gt;Please enable location services&lt;/string&gt;
&lt;key&gt;NSLocationAlwaysUsageDescription&lt;/key&gt;
&lt;string&gt;Please enable location services&lt;/string&gt;
</code></pre>

<h3>
<a id="implement-nearby-promotions-view" class="anchor" href="#implement-nearby-promotions-view" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implement nearby promotions view</h3>

<p>To create a nearby promotions view do the following:</p>

<ol>
<li>Create a new UITableViewController-based class.</li>
<li>
<p>Add <code>NSArray *_promotions</code>  to the implementation ivars:</p>

<pre><code>@implementation NearbyPromotionViewController {
    NSArray *_promotions;
}
</code></pre>
</li>
<li>
<p>Implement delegate methods as followed:</p>

<pre><code>- (void)viewWillAppear:(BOOL)animated {
    [[KocomojoManager sharedManager] retrieveNearbyPromotions:^(NSArray *promotions, NSError *error) {
        _promotions = promotions;
        [self.tableView reloadData];
    }];
};

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [_promotions count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell" forIndexPath:indexPath];

    KMPromotion *promotion = _promotions[indexPath.row];

    cell.textLabel.text = promotion.title;
    cell.detailTextLabel.text = promotion.tagline;

    return cell;
}

</code></pre>
</li>
</ol>

<p>To test the code you should configure new promotion using Kocomojo admin dashboard. If the beacon is in sight or you are in the geofence borders promotion should appear in the list.</p>

<h3>
<a id="implement-promotion-view" class="anchor" href="#implement-promotion-view" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implement promotion view</h3>

<ol>
<li>Create a new UIViewController-based class.</li>
<li>Add <code>@property KMPromotion *promotion;</code> to the class interface.</li>
<li>Create <code>UILabel *</code> objects for promotion title, description and <code>UIImageView *</code> for the promotion image.</li>
<li>Bind promotion fields to the labels and the image view in <code>viewWillAppear:</code> method.</li>
<li>
<p>Add <code>UIButton *</code> for the check-in action and bind it to the handler:</p>

<pre><code>- (IBAction)checkInButtonTouched:(id)sender {
    [[KocomojoManager sharedManager] checkIn:_promotion completion:^(KMPromotionState *state, NSError *error) {
        if (state.reward) {
            // go to reward view
        } else {
            // close promotion view
        }
    }];
}
</code></pre>
</li>
<li>
<p>Show promotion view when tapping on promotion in the nearby promotions table view. 
If using segues create a segue in storyboard from the table view cell to a promotion view controller and insert the following snippet into a nearby promotions view controller replacing segue identifier.</p>

<pre><code>- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"&lt;&lt;Promotion segue identifier&gt;&gt;"]) {
        KMPromotion *promotion = _promotions[[self.tableView indexPathForSelectedRow].row];
        [segue.destinationViewController setPromotion:promotion];
    }
}

</code></pre>
</li>
</ol>

<p>Test check-in action by tapping the button. If all promotion criteria are valid you should receive an updated <code>KMPromotionState *</code> with incremented count. If there are enough check-ins for the reward, then the <code>reward</code> property will be equal to <code>YES</code>.</p>

<h3>
<a id="implement-reward-view" class="anchor" href="#implement-reward-view" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implement reward view</h3>

<ol>
<li>Create a new UIViewController-based class.</li>
<li>Add <code>@property KMReward *reward;</code> to the class interface.</li>
<li>Create <code>UILabel *</code> objects for reward title, description and <code>UIImageView *</code> for the reward image.</li>
<li>Bind reward fields to the labels and the image view in <code>viewWillAppear:</code> method.</li>
<li>
<p>Show reward view when promotion view controller check-in completion callback called with promotion state reward equal to <code>YES</code>.</p>

<pre><code>- (IBAction)checkInButtonTouched:(id)sender {
    [[KocomojoManager sharedManager] checkIn:_promotion completion:^(KMPromotionState *state, NSError *error) {
        if (state.reward) {
            [self performSegueWithIdentifier:@"&lt;&lt;Reward segue identifier&gt;&gt;" sender:self];
        } 
        ...
    }];
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"&lt;&lt;Reward segue identifier&gt;&gt;"]) {
        [segue.destinationViewController setReward:_promotion.reward];
    }
}

</code></pre>
</li>
</ol>

<h3>
<a id="sample-application" class="anchor" href="#sample-application" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample application</h3>

<p>Sample application is available at <a href="https://github.com/KocomojoLLC/sample-ios-app">https://github.com/KocomojoLLC/sample-ios-app</a>.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/KocomojoLLC">KocomojoLLC</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
